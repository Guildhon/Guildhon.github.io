My Note
-------- 
> 磁盘管理

### df
查看磁盘分区使用状况
- -l 仅显示本地磁盘（默认）
- -a 显示所有文件系统的磁盘使用情况，包括比如/proc/
- -h 以1024进制计算最适合的单位显示磁盘容量
- -H 以1000进制计算最适合的单位显示磁盘容量
- -T 显示磁盘分区类型
- -t 显示指定类型文件系统的磁盘分区
- -x 不显示指定类型文件系统的磁盘分区

### du
统计磁盘上的文件大小
- -b 以byte为单位统计文件
- -k 以KB为单位统计文件
- -m 以MB为单位统计文件
- -h 按照1024进制以最适合的单位统计文件
- -H 按照1000进制以最适合的单位统计文件
- -s 指定统计目标

```
du -h ./*
```

### 知识点
一个硬盘
1. 主分区和扩展分区总数不能超过4个
2. 扩展分区最多只能只有一个
3. 扩展分区不能直接存取数据

### fdisk

Linux系统中硬件设备都是以文件的形式存在于根目录的dev目录中，硬件设备都是由Linux系统自动识别的。硬盘必须分区，格式化，挂载后才能使用。

```
fdisk -l // 查看可以使用的硬盘，比如看到disk /dev/sdb doesnot contain a valid partition table

fdisk /dev/sdb  // 进去分区模式


(1)
输入n
输入p （p代表主分区，e代表扩展分区）
回车默认选主分区编号1
选择扇区的开始位置，敲回车默认
选择扇区的结束位置，敲+3000M代表给3000M空间
(2)
输入n
输入e
回车
回车
回车
(3)
输入n
输入l （p代表主分区，l代表逻辑分区）


d删除分区
选择删除分区的编号	

p查看分区方案

w完成磁盘分区
```

### 硬盘分区模式
#### MBR
- 主分区不超过4个
- 单个分区容量最大2TB

#### GPT
- 主分区个数"几乎"没有限制，分区表最多可以支持128个主分区
- 单个分区容量"几乎"没有限制，最大到18EB
- GPT的主分区中，不适合安装X86架构的系统，即32位操作系统

```
# 交互模式
parted  // 启动分区工具
select /dev/sdc  //切换磁盘
mklabel gpt   // 选择模式
print        //打印硬盘信息

mkpart    // 个性化分区名称
imooc    // 名称，回车则默认空
ext2     // 分区格式化内容
0        // 分区从第几M开始
2000     // 两千M，可能会报没有对齐，有时需要牺牲来达到
cancel    // 可以取消掉
1        // 分区从第1M开始
2000     // 两千M
print
quit
```
```
# 命令模式，快速添加
parted  // 启动分区工具
mkpart test 2000 3000
```
删除分区
```
rm 3  // 分区编号，print可以看到
```

### 分区格式化
mkfs
只有主分区和逻辑分区可以格式化，扩展分区不可以
```
# 两种写法
mkfs.ext3 /dev/sdb1
mkfs -t ext4 /dev/sdb2  
```

### 分区挂载
分区默认挂载目录是/mnt目录
```
mkdir -p /mnt/imooc 
mount /dev/sdb1 /mnt/imooc
umount /mnt/imooc

# 为了系统重启依旧能生效
vim + /etc/fstab    # +代表非空行符下一行
/dev/sdb1  /mnt/imooc  ext3 defaults 0 0  # 设备名称，挂载点，文件系统类型
```

### swap分区
如何为硬盘添加swap交换分区
- 建立一个普通的Linux分区
- 修改分区类型的16进制编码
- 格式化交换分区
- 启动交换分区

```
fdisk /dev/sdb
p
t   # 修改编号
6
L   # 查看列表
82
p
w
mkswap /dev/sdb6
swapon /dev/sdb6
free
```